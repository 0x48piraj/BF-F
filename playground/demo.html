<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BF-F SDK Demo</title>

  <!-- Fake ad script bait -->
  <script async
    src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"
    onerror="window.adBlockerEnabled = true;">
  </script>

  <style>
    body {
      font-family: monospace;
      background: #0e0e0e;
      color: #ddd;
      padding: 20px;
    }
    .ok { color: #00ff9c; }
    .bad { color: #ff5f5f; }
    pre {
      border-top: 1px dashed #333;
      padding-top: 12px;
      margin-top: 12px;
    }
  </style>
</head>
<body>

<h1>BF-F SDK Demo</h1>

<pre id="adblock">Adblock: checking...</pre>
<pre id="bot">Bot: checking...</pre>

<script src="../dist/browser.global.js"></script>
<script>
(async function () {
  const engine = BFF.create()
  const adblock = await engine.detect('adblock')
  const bot = await engine.detect('bot')

  function render(id, result) {
    const el = document.getElementById(id)

    let output = ''
    output += id.toUpperCase() + '\n'
    output += 'Status: ' + (result.blocked ? 'DETECTED' : 'PASSED') + '\n'
    output +=
      'Suspicion: ' +
      Math.round(result.confidence * 100) +
      '%\n' +
      '(block confidence: ' +
      result.confidence.toFixed(2) +
      ')\n\n'
    output += 'Signals:\n'

    for (const s of result.signals) {
      const weight = s.weight ?? 1
      const confidence = s.confidence ?? 1
      const contribution = (weight * confidence).toFixed(2)

      output +=
        `- ${s.strategy}\n` +
        `  block: ${s.block}\n` +
        `  weight: ${weight}\n` +
        `  confidence: ${confidence}\n` +
        `  contribution: ${contribution}\n\n`
    }

    el.textContent = output
    el.className = result.blocked ? 'bad' : 'ok'
  }

  render('adblock', adblock)
  render('bot', bot)

  console.log('Full result', { adblock, bot })
})()
</script>

</body>
</html>
